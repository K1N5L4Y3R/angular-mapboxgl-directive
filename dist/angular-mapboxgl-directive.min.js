/*!
*  angular-mapboxgl-directive 0.1.0 2016-08-30
*  An AngularJS directive for Mapbox GL
*  git: git+https://github.com/Naimikan/angular-mapboxgl-directive.git
*/
!function(a,b,c){"use strict";a.module("mapboxgl-directive",[]).directive("mapboxgl",["$q","mapboxglUtils",function(c,d){function e(a){this._mapboxGlMap=c.defer(),this.getMap=function(){return this._mapboxGlMap.promise},this.getMapboxGlScope=function(){return a}}function f(c,e,f,g){if(!b)throw new Error("Mapbox GL does not included");if(!b.accessToken)throw new Error("Mapbox access token does not defined");if(!b.supported())throw new Error("Your browser does not support Mapbox GL");c.mapboxglMapId=f.id?f.id:d.generateMapId(),e.attr("id",c.mapboxglMapId);var h=function(){isNaN(f.width)?e.css("width",f.width):e.css("width",f.width+"px")},i=function(){isNaN(f.height)?e.css("height",f.height):e.css("height",f.height+"px")};a.isDefined(f.width)&&(h(),c.$watch(function(){return e[0].getAttribute("width")},function(){h()})),a.isDefined(f.height)&&(i(),c.$watch(function(){return e[0].getAttribute("height")},function(){i()}));var j=new b.Map({container:c.mapboxglMapId,style:"mapbox://styles/mapbox/streets-v9",center:[0,0],interactive:c.isInteractive||!0});g._mapboxGlMap.resolve(j),c.$on("$destroy",function(){j.remove()}),c.mapboxGlControls={},c.$watch(function(){return c.controlsAvailables},function(a,d){if(void 0!==a){if(void 0!==a.navigationControl&&void 0!==a.navigationControl.enabled&&a.navigationControl.enabled&&(c.mapboxGlControls.navigation=new b.Navigation({position:a.navigationControl.position||"top-right"}),c.mapboxGlMap.addControl(c.mapboxGlControls.navigation)),void 0!==a.geolocateControl&&void 0!==a.geolocateControl.enabled&&a.geolocateControl.enabled&&(c.mapboxGlControls.geolocate=new b.Geolocate({position:a.geolocateControl.position||"bottom-right"}),c.mapboxGlMap.addControl(c.mapboxGlControls.geolocate)),void 0!==a.scaleControl&&void 0!==a.scaleControl.enabled&&a.scaleControl.enabled){if(void 0===b.ScaleRule)throw new Error("mapboxgl.ScaleRule plugin is not included.");c.mapboxGlControls.scaleRule=new b.ScaleRule({position:a.scaleControl.position||"bottom-left"}),c.mapboxGlMap.addControl(c.mapboxGlControls.scaleRule)}if(void 0!==a.drawControl&&void 0!==a.drawControl.enabled&&a.drawControl.enabled){if(void 0===b.DrawGl)throw new Error("mapboxgl.DrawGl plugin is not included.");c.mapboxGlControls.drawGl=new b.DrawGl({position:a.drawControl.position||"top-left",drawOptions:a.drawControl.drawOptions?{polyline:!!a.drawControl.drawOptions.polyline&&a.drawControl.drawOptions.polyline,polygon:!!a.drawControl.drawOptions.polygon&&a.drawControl.drawOptions.polygon,rectangle:!!a.drawControl.drawOptions.rectangle&&a.drawControl.drawOptions.rectangle,circle:!!a.drawControl.drawOptions.circle&&a.drawControl.drawOptions.circle,marker:!!a.drawControl.drawOptions.marker&&a.drawControl.drawOptions.marker,edit:!a.drawControl.drawOptions.edit||a.drawControl.drawOptions.edit,trash:!a.drawControl.drawOptions.trash||a.drawControl.drawOptions.trash}:{polyline:!0,polygon:!0,rectangle:!0,circle:!0,marker:!0,edit:!0,trash:!0},distanceUnit:b.DrawGl.DISTANCE_UNITS.meters}),c.mapboxGlMap.addControl(c.mapboxGlControls.drawGl)}}})}var g={restrict:"EA",replace:!0,scope:{glStyle:"=",glCenter:"=",glMinZoom:"=",glMaxZoom:"=",glZoom:"=",glBearing:"=",glPitch:"=",isInteractive:"=",controlsAvailables:"="},transclude:!0,template:'<div class="angular-mapboxgl-map"><div ng-transclude></div></div>',controller:e,link:f};return e.$inject=["$scope"],g}]),a.module("mapboxgl-directive").factory("mapboxglUtils",[function(){function b(){return"mapbox-gl-map-"+Date.now()}function c(b){var c=null;if(a.isDefined(b)){if(a.isNumber(b.lat)&&a.isNumber(b.lng)&&(b.lng>-180||b.lng<180)&&(b.lat>-90||b.lat<90))c=[b.lng,b.lat];else{if(!(a.isArray(b)&&2===b.length&&a.isNumber(b[0])&&a.isNumber(b[1])&&(b[0]>-180||b[0]<180)&&(b[1]>-90||b[1]<90)))return!1;c=b}return c}return!1}var d={generateMapId:b,validateAndFormatCenter:c};return d}]),a.module("mapboxgl-directive").directive("glBearing",[function(){function b(b,c,d,e){if(!e)throw new Error("Invalid angular-mapboxgl-directive controller");var f=e.getMapboxGlScope();e.getMap().then(function(b){f.$watch("glBearing",function(c){if(!a.isNumber(c))throw new Error("Invalid bearing");b.setBearing(c)},!0)})}var c={restrict:"A",scope:!1,replace:!1,require:"?^mapboxgl",link:b};return c}]),a.module("mapboxgl-directive").directive("glCenter",["mapboxglUtils",function(a){function b(b,c,d,e){if(!e)throw new Error("Invalid angular-mapboxgl-directive controller");var f=e.getMapboxGlScope();e.getMap().then(function(b){f.$watch("glCenter",function(c){if(c=a.validateAndFormatCenter(c),!c)throw new Error("Invalid center");b.panTo(c)},!0)})}var c={restrict:"A",scope:!1,replace:!1,require:"?^mapboxgl",link:b};return c}]),a.module("mapboxgl-directive").directive("glControls",[function(){function c(c,d,e,f){if(!f)throw new Error("Invalid angular-mapboxgl-directive controller");var g=f.getMapboxGlScope(),h={};f.getMap().then(function(c){g.$watch("glControls",function(d){a.isDefined(d.navigation)&&a.isDefined(d.navigation.enabled)&&d.navigation.enabled&&(h.navigation=new b.Navigation({position:d.navigation.position||"top-right"}),c.addControl(h.navigation))},!0)})}var d={restrict:"A",scope:!1,replace:!1,require:"?^mapboxgl",link:c};return d}]),a.module("mapboxgl-directive").directive("glMaxBounds",[function(){function b(b,c,d,e){if(!e)throw new Error("Invalid angular-mapboxgl-directive controller");var f=e.getMapboxGlScope();e.getMap().then(function(b){f.$watch("glMaxBounds",function(c){if(!a.isArray(c)||2!==c.length)throw new Error("Invalid max bounds");b.setMaxBounds(c)},!0)})}var c={restrict:"A",scope:!1,replace:!1,require:"?^mapboxgl",link:b};return c}]),a.module("mapboxgl-directive").directive("glMaxZoom",[function(){function b(b,c,d,e){if(!e)throw new Error("Invalid angular-mapboxgl-directive controller");var f=e.getMapboxGlScope();e.getMap().then(function(b){f.$watch("glMaxZoom",function(c){if(!a.isNumber(c)||!(c>=0||c<=20))throw new Error("Invalid max zoom");b.setMaxZoom(c)},!0)})}var c={restrict:"A",scope:!1,replace:!1,require:"?^mapboxgl",link:b};return c}]),a.module("mapboxgl-directive").directive("glMinZoom",[function(){function b(b,c,d,e){if(!e)throw new Error("Invalid angular-mapboxgl-directive controller");var f=e.getMapboxGlScope();e.getMap().then(function(b){f.$watch("glMinZoom",function(c){if(!a.isNumber(c)||!(c>=0||c<=20))throw new Error("Invalid min zoom");b.setMinZoom(c)},!0)})}var c={restrict:"A",scope:!1,replace:!1,require:"?^mapboxgl",link:b};return c}]),a.module("mapboxgl-directive").directive("glPitch",[function(){function b(b,c,d,e){if(!e)throw new Error("Invalid angular-mapboxgl-directive controller");var f=e.getMapboxGlScope();e.getMap().then(function(b){f.$watch("glPitch",function(c){if(!a.isNumber(c)||!(c>=0||c<=60))throw new Error("Invalid pitch");b.setPitch(c)},!0)})}var c={restrict:"A",scope:!1,replace:!1,require:"?^mapboxgl",link:b};return c}]),a.module("mapboxgl-directive").directive("glStyle",[function(){function a(a,b,c,d){if(!d)throw new Error("Invalid angular-mapboxgl-directive controller");var e=d.getMapboxGlScope();d.getMap().then(function(a){e.$watch("glStyle",function(b){a.setStyle(b)},!0)})}var b={restrict:"A",scope:!1,replace:!1,require:"?^mapboxgl",link:a};return b}]),a.module("mapboxgl-directive").directive("glZoom",[function(){function b(b,c,d,e){if(!e)throw new Error("Invalid angular-mapboxgl-directive controller");var f=e.getMapboxGlScope();e.getMap().then(function(b){f.$watch("glZoom",function(c){if(!a.isNumber(c)||!(c>=0||c<=20))throw new Error("Invalid zoom");b.setZoom(c)},!0)})}var c={restrict:"A",scope:!1,replace:!1,require:"?^mapboxgl",link:b};return c}])}(angular,mapboxgl);