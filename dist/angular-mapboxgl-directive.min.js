/*!
*  angular-mapboxgl-directive 0.1.0 2016-08-28
*  An AngularJS directive for Mapbox GL
*  git: git+https://github.com/Naimikan/angular-mapboxgl-directive.git
*/
!function(a,b,c){"use strict";a.module("mapboxgl-directive",[]).directive("mapboxgl",["$q","mapboxglUtils",function(c,d){function e(a){this._mapboxGlMap=c.defer(),this.getMap=function(){return this._mapboxGlMap.promise},this.getMapboxGlScope=function(){return a}}function f(c,e,f,g){if(!b)throw new Error("Mapbox GL does not included");if(!b.accessToken)throw new Error("Mapbox access token does not defined");if(!b.supported())throw new Error("Your browser does not support Mapbox GL");c.mapboxglMapId=f.id?f.id:d.generateMapId(),e.attr("id",c.mapboxglMapId);var h=function(){isNaN(f.width)?e.css("width",f.width):e.css("width",f.width+"px")},i=function(){isNaN(f.height)?e.css("height",f.height):e.css("height",f.height+"px")};a.isDefined(f.width)&&(h(),c.$watch(function(){return e[0].getAttribute("width")},function(){h()})),a.isDefined(f.height)&&(i(),c.$watch(function(){return e[0].getAttribute("height")},function(){i()}));var j=new b.Map({container:c.mapboxglMapId,style:"mapbox://styles/mapbox/streets-v9",center:[0,0],interactive:c.isInteractive||!0});g._mapboxGlMap.resolve(j),c.$on("$destroy",function(){j.remove()}),c.mapboxGlControls={},c.$watch(function(){return c.controlsAvailables},function(a,d){if(void 0!==a){if(void 0!==a.navigationControl&&void 0!==a.navigationControl.enabled&&a.navigationControl.enabled&&(c.mapboxGlControls.navigation=new b.Navigation({position:a.navigationControl.position||"top-right"}),c.mapboxGlMap.addControl(c.mapboxGlControls.navigation)),void 0!==a.geolocateControl&&void 0!==a.geolocateControl.enabled&&a.geolocateControl.enabled&&(c.mapboxGlControls.geolocate=new b.Geolocate({position:a.geolocateControl.position||"bottom-right"}),c.mapboxGlMap.addControl(c.mapboxGlControls.geolocate)),void 0!==a.scaleControl&&void 0!==a.scaleControl.enabled&&a.scaleControl.enabled){if(void 0===b.ScaleRule)throw new Error("mapboxgl.ScaleRule plugin is not included.");c.mapboxGlControls.scaleRule=new b.ScaleRule({position:a.scaleControl.position||"bottom-left"}),c.mapboxGlMap.addControl(c.mapboxGlControls.scaleRule)}if(void 0!==a.drawControl&&void 0!==a.drawControl.enabled&&a.drawControl.enabled){if(void 0===b.DrawGl)throw new Error("mapboxgl.DrawGl plugin is not included.");c.mapboxGlControls.drawGl=new b.DrawGl({position:a.drawControl.position||"top-left",drawOptions:a.drawControl.drawOptions?{polyline:!!a.drawControl.drawOptions.polyline&&a.drawControl.drawOptions.polyline,polygon:!!a.drawControl.drawOptions.polygon&&a.drawControl.drawOptions.polygon,rectangle:!!a.drawControl.drawOptions.rectangle&&a.drawControl.drawOptions.rectangle,circle:!!a.drawControl.drawOptions.circle&&a.drawControl.drawOptions.circle,marker:!!a.drawControl.drawOptions.marker&&a.drawControl.drawOptions.marker,edit:!a.drawControl.drawOptions.edit||a.drawControl.drawOptions.edit,trash:!a.drawControl.drawOptions.trash||a.drawControl.drawOptions.trash}:{polyline:!0,polygon:!0,rectangle:!0,circle:!0,marker:!0,edit:!0,trash:!0},distanceUnit:b.DrawGl.DISTANCE_UNITS.meters}),c.mapboxGlMap.addControl(c.mapboxGlControls.drawGl)}}}),c.$watch(function(){return c.mapMinZoom},function(b,d){if(void 0!==b){var e=0;a.isNumber(b)?e=b:console.warn("Invalid Min Zoom. Changing to "+e),c.mapboxGlMap.setMinZoom(e)}}),c.$watch(function(){return c.mapMaxZoom},function(b,d){if(void 0!==b){var e=20;a.isNumber(b)?e=b:console.warn("Invalid Max Zoom. Changing to "+e),c.mapboxGlMap.setMaxZoom(e)}}),c.$watch(function(){return c.mapZoom},function(b,d){if(void 0!==b){var e=9;a.isNumber(b)?e=b:console.warn("Invalid Zoom. Changing to "+e),c.mapboxGlMap.setZoom(e)}}),c.$watch(function(){return c.mapBearing},function(b,d){if(void 0!==b){var e=0;a.isNumber(b)?e=b:console.warn("Invalid Bearing. Changing to "+e),c.mapboxGlMap.setBearing(e)}}),c.$watch(function(){return c.mapPitch},function(b,d){if(void 0!==b){var e=0;a.isNumber(b)?e=b:console.warn("Invalid Pitch. Changing to "+e),c.mapboxGlMap.setPitch(e)}})}var g={restrict:"EA",replace:!0,scope:{glStyle:"=",glCenter:"=",mapMinZoom:"=",mapMaxZoom:"=",mapZoom:"=",mapBearing:"=",mapPitch:"=",isInteractive:"=",controlsAvailables:"="},transclude:!0,template:'<div class="angular-mapboxgl-map"><div ng-transclude></div></div>',controller:e,link:f};return e.$inject=["$scope"],g}]),a.module("mapboxgl-directive").factory("mapboxglUtils",[function(){function a(){return"mapbox-gl-map-"+Date.now()}var b={generateMapId:a};return b}]),a.module("mapboxgl-directive").directive("glCenter",[function(){function b(b,c,d,e){if(!e)throw new Error("Invalid angular-mapboxgl-directive controller");var f=e.getMapboxGlScope();e.getMap().then(function(b){f.$watch("glCenter",function(c){var d=[0,0];void 0!==c.lat&&void 0!==c.lng?d=[c.lat,c.lng]:a.isArray(c)&&2===c.length&&(d=c),b.setCenter(d)},!0)})}var c={restrict:"A",scope:!1,replace:!1,require:"?^mapboxgl",link:b};return c}]),a.module("mapboxgl-directive").directive("glStyle",[function(){function a(a,b,c,d){if(!d)throw new Error("Invalid angular-mapboxgl-directive controller");var e=d.getMapboxGlScope();d.getMap().then(function(a){e.$watch("glStyle",function(b){a.setStyle(b)},!0)})}var b={restrict:"A",scope:!1,replace:!1,require:"?^mapboxgl",link:a};return b}])}(angular,mapboxgl);